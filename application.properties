# Docker/K8s Secret 연동: /run/secrets/ 경로의 파일들을 속성으로 로드 (파일명=Key, 내용=Value)
# 로컬 테스트를 위해 ./secrets/ 경로 추가 (우선순위: 로컬 파일 -> 시스템 경로)
# optional:을 붙여서 해당 경로가 없어도 다음 경로를 찾도록 설정
spring.config.import=optional:configtree:/run/secrets/,optional:configtree:./secrets/

spring.application.name=config-server
server.port=8888

# Native 프로필 활성화 (Git 대신 로컬 파일 시스템 사용)
# Git을 사용하려면 native 프로필을 비활성화해야 합니다.
# spring.profiles.active=native

# config 저장소 경로 (Git, 파일 등)
# 설정 전용 리포지토리로 변경 (예시 URL)
spring.cloud.config.server.git.uri=https://github.com/juyoulchoi/nanum-msa-config.git
# 설정 파일들이 리포지토리의 하위 폴더에 있다면 해당 폴더명들을 쉼표로 구분하여 지정 (기본값: 루트)
# spring.cloud.config.server.git.search-paths=common,services,databases
spring.cloud.config.server.git.username=juyoulchoi
# Jasypt 암호화 적용 (실제 암호화된 값으로 교체 필요)
# 우선순위: Secret 파일(git-password) -> 환경변수(GIT_PASSWORD) -> Jasypt 암호화 값(Local)
spring.cloud.config.server.git.password=${git-password:${GIT_PASSWORD:ENC(암호화된_비밀번호_입력)}}
# Git 연결 실패 시 로컬 캐시된 파일로 서비스하기 위한 설정 (Clone 경로 고정)
spring.cloud.config.server.git.basedir=./config-git-cache
# Git 저장소 변경 감지 주기 (초 단위)
# 0: 매 요청마다 Git Fetch 수행 (기본값, 실시간성 높음)
# 30: 마지막 Fetch 이후 30초 동안은 로컬 캐시 사용 (Git 부하 감소)
spring.cloud.config.server.git.refresh-rate=0

# 또는 파일 시스템 사용 시
# Native(로컬 파일) 모드 사용 시 검색할 경로 (Git Push 없이 로컬 파일 즉시 반영)
# 프로젝트 루트(nanum-msa)와 같은 레벨에 있는 'nanum-msa-config' 폴더를 바라보도록 설정
spring.cloud.config.server.native.search-locations=file:../nanum-msa-config/,file:./nanum-msa-config/

eureka.instance.hostname=localhost
eureka.client.register-with-eureka=false
eureka.client.fetch-registry=false
eureka.client.service-url.defaultZone=http://localhost:8761/eureka/

# Actuator 설정 (Bus Refresh 노출)
management.endpoints.web.exposure.include=health,info,bus-refresh,refresh,env

# 필요시 인증/보안 설정
# spring.security.user.name=admin
# spring.security.user.password=admin
spring.security.users[0].username=admin
spring.security.users[0].password=${admin-password:admin123}
spring.security.users[0].roles=ADMIN

spring.security.users[1].username=dev
spring.security.users[1].password=${dev-password:dev123}
spring.security.users[1].roles=DEVELOPER

spring.security.users[2].username=viewer
spring.security.users[2].password=${viewer-password:viewer123}
spring.security.users[2].roles=VIEWER
