# 모든 서비스 공통 설정 (기존 application-common.properties 내용)
# Docker/K8s Secret 연동: /run/secrets/ 경로의 파일들을 속성으로 로드
# 로컬 테스트를 위해 ./secrets/ 경로 추가 (우선순위: 로컬 파일 -> 시스템 경로)
spring.config.import=optional:configtree:/run/secrets/,optional:configtree:./secrets/

# JWT 공통 설정
jwt.header=Authorization
jwt.prefix=Bearer
# 우선순위: Secret 파일(jwt-secret) -> 환경변수(JWT_SECRET) -> 기본값(Local)
jwt.secret=${jwt-secret:${JWT_SECRET:A8735B3E74A28539D9C18CB279555236B4FA655847490DBD130B313D4881B155}}
jwt.public-routes=/api/auth/login,/api/auth/register,/api/auth/refresh,/actuator/health,/actuator/info

# 모든 profile 공통 설정
server.port=8080
server.error.include-message=never
server.forward-headers-strategy=framework
spring.session.timeout=30m

management.endpoints.web.exposure.include=health,info,metrics,prometheus,refresh,bus-refresh,env
management.endpoint.health.show-details=when_authorized
management.prometheus.metrics.export.enabled=true

# 로깅 (운영은 WARN 권장), 각 profile 별로 관리
# logging.level.org.springframework=INFO
# logging.level.org.mybatis=INFO
logging.pattern.console=%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# JPA (공통 기본)
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
# Dialect는 각 db-*.properties 파일에서 정의함
# spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true

# 공통 프로필 그룹 정의: 'local' 프로필 활성화 시 'local-infra', 'local-kafka' 프로필도 함께 활성화
spring.profiles.group.local=local-infra,local-kafka
spring.profiles.group.dev=dev-infra,dev-kafka
spring.profiles.group.prod=prod-infra,prod-kafka

# 서버 정보 - 세션 설정
server.servlet.session.cookie.name=NANUMSESSION
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=false
server.servlet.session.cookie.same-site=Lax
